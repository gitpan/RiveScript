<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>RiveScript - Rendering Intelligence Very Easily</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#perl_package">PERL PACKAGE</a></li>
	<ul>

		<li><a href="#public_methods">Public Methods</a></li>
		<li><a href="#security_methods">Security Methods</a></li>
		<li><a href="#private_methods">Private Methods</a></li>
	</ul>

	<li><a href="#rivescript">RIVESCRIPT</a></li>
	<ul>

		<li><a href="#rivescript_format">RiveScript Format</a></li>
		<li><a href="#rivescript_commands">RiveScript Commands</a></li>
		<li><a href="#rivescript_holds_the_keys">RiveScript Holds The Keys</a></li>
		<li><a href="#complexities_of_the_trigger">Complexities of the Trigger</a></li>
		<li><a href="#complexities_of_the_response">Complexities of the Response</a></li>
		<li><a href="#begin_statement">Begin Statement</a></li>
		<li><a href="#topics">Topics</a></li>
		<li><a href="#object_macros">Object Macros</a></li>
		<li><a href="#tags">Tags</a></li>
		<li><a href="#environment_variables">Environment Variables</a></li>
		<li><a href="#person_substitution">Person Substitution</a></li>
		<li><a href="#dynamic_replies">Dynamic Replies</a></li>
		<li><a href="#included_files">Included Files</a></li>
		<li><a href="#reserved_variables">Reserved Variables</a></li>
		<li><a href="#a_good_brain">A Good Brain</a></li>
	</ul>

	<li><a href="#see_other">SEE OTHER</a></li>
	<li><a href="#changes">CHANGES</a></li>
	<li><a href="#special_thanks">SPECIAL THANKS</a></li>
	<li><a href="#keywords">KEYWORDS</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#copyright_and_license">COPYRIGHT AND LICENSE</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>RiveScript - Rendering Intelligence Very Easily</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
  <span class="keyword">use</span> <span class="variable">RiveScript</span><span class="operator">;</span>
</pre>
<pre>
  <span class="comment"># Create a new RiveScript interpreter.</span>
  <span class="keyword">my</span> <span class="variable">$rs</span> <span class="operator">=</span> <span class="variable">new</span> <span class="variable">RiveScript</span><span class="operator">;</span>
</pre>
<pre>
  <span class="comment"># Load some replies.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="variable">loadDirectory</span> <span class="operator">(</span><span class="string">"./replies"</span><span class="operator">);</span>
</pre>
<pre>
  <span class="comment"># Load in another file.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="variable">loadFile</span> <span class="operator">(</span><span class="string">"./more_replies.rs"</span><span class="operator">);</span>
</pre>
<pre>
  <span class="comment"># Stream in even more RiveScript code.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="variable">stream</span> <span class="operator">(</span><span class="string">q~! global split_sentences = 1~</span><span class="operator">);</span>
</pre>
<pre>
  <span class="comment"># Sort all the loaded replies.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="variable">sortReplies</span><span class="operator">;</span>
</pre>
<pre>
  <span class="comment"># Grab a response.</span>
  <span class="keyword">my</span> <span class="variable">@reply</span> <span class="operator">=</span> <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="variable">reply</span> <span class="operator">(</span><span class="string">'localscript'</span><span class="operator">,</span> <span class="string">'Hello RiveScript!'</span><span class="operator">);</span>
  <span class="keyword">print</span> <span class="keyword">join</span> <span class="operator">(</span><span class="string">"\n"</span><span class="operator">,</span> <span class="variable">@reply</span><span class="operator">),</span> <span class="string">"\n"</span><span class="operator">;</span>
</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>RiveScript is a simple input/response language. It has a simple, easy-to-learn syntax,
yet it is more powerful even than Dr. Wallace's AIML (Artificial Intelligence Markup Language).
RiveScript was created as a reply language for chatterbots, but it has been used for
more complex things above and beyond that.</p>
<p>
</p>
<hr />
<h1><a name="perl_package">PERL PACKAGE</a></h1>
<p>This part of the manpage documents the methods of the Perl RiveScript library. The RiveScript
language specifications are below: see <a href="#rivescript">RIVESCRIPT</a>.</p>
<p>
</p>
<h2><a name="public_methods">Public Methods</a></h2>
<dl>
<dt><strong><a name="item_new">new</a></strong>

<dd>
<p>Creates a new RiveScript instance.</p>
</dd>
</li>
<dt><strong><a name="item_setsubroutine">setSubroutine (OBJECT_NAME =&gt; CODEREF)</a></strong>

<dd>
<p>Define an object macro (see <a href="#object_macros">Object Macros</a>)</p>
</dd>
</li>
<dt><strong><a name="item_loaddirectory">loadDirectory ($DIRECTORY[, @EXTS])</a></strong>

<dd>
<p>Load a directory of RiveScript files. <code>@EXTS</code> is optionally an array of file extensions
to load, in the format <code>(.rs .txt .etc)</code>. Default is just ``.rs''</p>
</dd>
</li>
<dt><strong><a name="item_loadfile">loadFile ($FILEPATH[, $STREAM])</a></strong>

<dd>
<p>Load a single RiveScript file. Don't worry about the <code>$STREAM</code> argument, it is handled
in the <a href="#item_stream"><code>stream()</code></a> method.</p>
</dd>
</li>
<dt><strong><a name="item_stream">stream ($CODE)</a></strong>

<dd>
<p>Stream RiveScript codes directly into the module.</p>
</dd>
</li>
<dt><strong><a name="item_sortreplies">sortReplies</a></strong>

<dd>
<p>Sorts all the loaded replies. This is necessary for reply matching purposes. If you fail
to call this method yourself, it will be called automatically with <a href="#item_reply"><code>reply()</code></a>, but not without
a nasty Perl warning. It's better to always sort them yourself, for example if you load in
new replies later, they won't be matchible unless a new <a href="#item_sortreplies"><code>sortReplies</code></a> is called.</p>
</dd>
</li>
<dt><strong><a name="item_reply">reply ($USER_ID, $MESSAGE[, %TAGS])</a></strong>

<dd>
<p>Get a reply from the bot. This will (normally) return an array. The values of the array
would be all the replies to that message (i.e. if you use the <a href="#item__7bnextreply_7d"><code>{nextreply}</code></a> tag in a
response, or if you pass in multiple sentences).</p>
</dd>
<dd>
<p><code>%TAGS</code> is optionally a hash of special reply tags. Each value is boolean.</p>
</dd>
<dd>
<pre>
  <span class="keyword">scalar</span>   <span class="operator">=</span> <span class="variable">Forces</span> <span class="variable">the</span> <span class="keyword">return</span> <span class="variable">value</span> <span class="variable">into</span> <span class="variable">a</span> <span class="keyword">scalar</span> <span class="variable">instead</span> <span class="variable">of</span> <span class="variable">an</span> <span class="variable">array</span>
  <span class="variable">no_split</span> <span class="operator">=</span> <span class="variable">Don't</span> <span class="variable">run</span> <span class="variable">sentence</span><span class="operator">-</span><span class="variable">splitters</span> <span class="variable">on</span> <span class="variable">the</span> <span class="variable">message</span><span class="operator">.</span>
  <span class="variable">retry</span>    <span class="operator">=</span> <span class="variable">INTERNAL</span><span class="operator">.</span> <span class="variable">Tells</span> <span class="variable">the</span> <span class="variable">module</span> <span class="variable">that</span> <span class="variable">it's</span> <span class="variable">on</span> <span class="variable">a</span> <span class="variable">retry</span> <span class="variable">run</span><span class="operator">,</span> <span class="keyword">for</span> <span class="variable">special</span> <span class="variable">cases</span>
             <span class="variable">such</span> <span class="variable">as</span> <span class="operator">;)</span> <span class="operator">-</span> <span class="variable">winking</span> <span class="variable">emoticon</span> <span class="operator">-</span> <span class="variable">since</span> <span class="operator">;</span> <span class="variable">is</span> <span class="variable">a</span> <span class="variable">default</span> <span class="variable">sentence</span><span class="operator">-</span><span class="variable">splitter</span><span class="operator">.</span>
</pre>
</dd>
</li>
<dt><strong><a name="item_search">search ($STRING)</a></strong>

<dd>
<p>Search all loaded replies for every trigger that <code>$STRING</code> matches. Returns an array
of results, containing the trigger, what topic it was under, and its file and line number
where applicable.</p>
</dd>
</li>
<dt><strong><a name="item_write">write ([$FILEPATH])</a></strong>

<dd>
<p>Writes all the currently loaded replies into a single file. This is useful for if your
application dynamically learns replies by editing the loaded hashrefs. It will write all
replies to the file under their own topics. Comments and other unnessecary information is
ignored.</p>
</dd>
<dd>
<p>The default path is to ``written.rs'' in the working directory.</p>
</dd>
<dd>
<p><strong>Note:</strong> This method doesn't honor the <code>%PREVIOUS</code> command in RiveScript.</p>
</dd>
<dd>
<p>See <a href="#dynamic_replies">Dynamic Replies</a>.</p>
</dd>
</li>
<dt><strong><a name="item_setglobal">setGlobal (VARIABLE =&gt; VALUE, ...)</a></strong>

<dd>
<p>Set a global RiveScript variable directly from Perl (alias for <code>! global</code>)</p>
</dd>
</li>
<dt><strong><a name="item_setvariable">setVariable (VARIABLE =&gt; VALUE, ...)</a></strong>

<dd>
<p>Set a botvariable (alias for <code>! var</code>)</p>
</dd>
</li>
<dt><strong><a name="item_setsubstitution">setSubstitution (BEFORE =&gt; AFTER, ...)</a></strong>

<dd>
<p>Set a substitution setting (alias for <code>! sub</code>)</p>
</dd>
</li>
<dt><strong><a name="item_setuservar">setUservar ($USER_ID, VARIABLE =&gt; VALUE, ...)</a></strong>

<dd>
<p>Set a user variable (alias for <code>&lt;set var=value&gt;</code> for <code>$USER_ID</code>)</p>
</dd>
</li>
<dt><strong><a name="item_getuservars">getUservars ([$USER_ID])</a></strong>

<dd>
<p>Get all uservars for a user. Returns a hashref of the variables. If you don't pass in a
<code>$USER_ID</code>, it will return a hashref of hashrefs for each user by their ID.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="security_methods">Security Methods</a></h2>
<p>The RiveScript interpreter can specify some security settings as far as what a
RiveScript file is allowed to contain.</p>
<p><strong>Note:</strong> These settings only apply to commands found in a RiveScript document
while it's being loaded. It does not apply to tags within RiveScript responses
(for example <code>{! global ...}</code> could be used in a reply to reset a global variable.
This can't be helped with these commands. For ultimate security, you should have
your program manually check these things).</p>
<dl>
<dt><strong><a name="item_denymode">denyMode ($MODE)</a></strong>

<dd>
<p>Valid modes are <code>deny_some</code>, <code>allow_some</code>, and <code>allow_all</code>. allow_all is the default.
Use the <a href="#item_deny"><code>deny()</code></a> and <a href="#item_allow"><code>allow()</code></a> methods complementary to the denyMode specified.</p>
</dd>
</li>
<dt><strong><a name="item_deny">deny (@COMMANDS)</a></strong>

<dd>
<p>Add <code>@COMMANDS</code> to the denied commands list. These can be single commands or beginnings
of command texts. Example:</p>
</dd>
<dd>
<pre>
  <span class="variable">$rivescript</span><span class="operator">-&gt;</span><span class="variable">deny</span> <span class="operator">(</span>
    <span class="string">'&amp;'</span><span class="operator">,</span>
    <span class="string">'! global'</span><span class="operator">,</span>
    <span class="string">'! var copyright'</span><span class="operator">,</span>
    <span class="string">'&gt; begin'</span><span class="operator">,</span>
    <span class="string">'&lt; begin'</span><span class="operator">,</span>
    <span class="string">'&gt; __begin__'</span><span class="operator">,</span>
    <span class="string">'&lt; __begin__'</span><span class="operator">,</span>
  <span class="operator">);</span>
</pre>
</dd>
<dd>
<p>In that example, <code>&amp;PERL</code>, <code>!GLOBAL</code>, the botvariable <code>copyright</code>, and the <code>BEGIN</code>
statements (and its internal names) are all blocked from being accepted in any loaded
RiveScript file.</p>
</dd>
</li>
<dt><strong><a name="item_allow">allow (@COMMANDS)</a></strong>

<dd>
<p>Add <code>@COMMANDS</code> to the allowed commands list. For the highest security, it would be better
to <code>allow_some</code> commands rather than <code>deny_some</code>.</p>
</dd>
<dd>
<pre>
  <span class="variable">$rivescript</span><span class="operator">-&gt;</span><span class="variable">allow</span> <span class="operator">(</span>
    <span class="string">'+'</span><span class="operator">,</span>
    <span class="string">'-'</span><span class="operator">,</span>
    <span class="string">'! var'</span><span class="operator">,</span>
    <span class="string">'@'</span><span class="operator">,</span>
  <span class="operator">);</span>
</pre>
</dd>
<dd>
<p>That example would deny every command <em>except</em> for triggers, responses, botvariable
setters, and redirections.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="private_methods">Private Methods</a></h2>
<p>These methods are called on internally and should not be called by you.</p>
<dl>
<dt><strong><a name="item_debug">debug ($MESSAGE)</a></strong>

<dd>
<p>Print a debug message (when debug mode is active).</p>
</dd>
</li>
<dt><strong><a name="item_makeparser">makeParser</a></strong>

<dd>
<p>Creates a <a href="/RiveScript/Parser.html">RiveScript::Parser</a> instance, passing in the current data
held by <code>RiveScript</code>. This call is made before using the parser (to read or write replies)
and destroyed when no longer needed.</p>
</dd>
</li>
<dt><strong><a name="item_intreply">intReply ($USER_ID, $MESSAGE)</a></strong>

<dd>
<p>This is the internal reply-getting routine. Call <a href="#item_reply"><code>reply()</code></a> instead. This assumes that the
data is all correctly formatted before being processed.</p>
</dd>
</li>
<dt><strong><a name="item_splitsentences">splitSentences ($STRING)</a></strong>

<dd>
<p>Splits <code>$STRING</code> at hte sentence-splitters and returns an array.</p>
</dd>
</li>
<dt><strong><a name="item_formatmessage">formatMessage ($STRING)</a></strong>

<dd>
<p>Formats <code>$STRING</code> by running substitutions and removing punctuation and symbols.</p>
</dd>
</li>
<dt><strong><a name="item_mergewildcards">mergeWildcards ($STRING, @STARS)</a></strong>

<dd>
<p>Merges the values from <code>@STARS</code> into <code>$STRING</code>, where the items in <code>@STARS</code> correspond
to a captured value from <code>$1</code> to <code>$100+</code>. The first item in the array should be blank as
there is no <code>&lt;star0&gt;</code>.</p>
</dd>
</li>
<dt><strong><a name="item_stringutil">stringUtil ($TYPE, $STRING)</a></strong>

<dd>
<p>Formats <code>$STRING</code> by <code>$TYPE</code> (uppercase, lowercase, formal, sentence).</p>
</dd>
</li>
<dt><strong><a name="item_tagfilter">tagFilter ($REPLY, $ID, $MESSAGE)</a></strong>

<dd>
<p>Run tag filters on <code>$REPLY</code>. Returns the new <code>$REPLY</code>.</p>
</dd>
</li>
<dt><strong><a name="item_tagshortcuts">tagShortcuts ($REPLY)</a></strong>

<dd>
<p>Runs shortcut tags on <code>$REPLY</code>. Returns the new <code>$REPLY</code>.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="rivescript">RIVESCRIPT</a></h1>
<p>The following is the RiveScript 1.00 specification.</p>
<p>
</p>
<h2><a name="rivescript_format">RiveScript Format</a></h2>
<p>RiveScript is a line-by-line command-driven language. The first <code>symbol(s)</code> of each line is
a <strong>command</strong>, and the following text is its <strong>data</strong>.</p>
<p>In its most simple form, a valid RiveScript reply looks like this:</p>
<pre>
  + hello bot
  - Hello human.</pre>
<p>
</p>
<h2><a name="rivescript_commands">RiveScript Commands</a></h2>
<dl>
<dt><strong><a name="item__21__28definition_29"><strong>! (Definition)</strong></a></strong>

<dd>
<p>The <code>!</code> command is for definitions. These are used to define variables and arrays at load
time. Their format is as follows:</p>
</dd>
<dd>
<pre>
  ! $type $variable = $value</pre>
</dd>
<dd>
<p>The supported types are as follows:</p>
</dd>
<dd>
<pre>
  global  - Global settings (eg. debug and sentence_splitters)
  var     - BotVariables (eg. the bot's name, age, etc)
  array   - An array
  sub     - A substitution pattern
  person  - A &quot;person&quot; substitution pattern
  addpath - Add an include path for RiveScript includibles
  include - Include a separate RiveScript library or package
  syslib  - Include a Perl module into the RiveScript:: namespace.</pre>
</dd>
<dd>
<p>Some examples:</p>
</dd>
<dd>
<pre>
  // Set global variables (defaults)
  ! global debug = 0
  ! global split_sentences = 1
  ! global sentence_splitters = . ! ; ?</pre>
</dd>
<dd>
<pre>
  // Setup a handler string for object failures.
  ! global macro_failure = &lt;b&gt;ERROR: Macro Failure&lt;/b&gt;</pre>
</dd>
<dd>
<pre>
  // Set bot vars
  ! var name   = Casey Rive
  ! var age    = 14
  ! var gender = male
  ! var color  = blue</pre>
</dd>
<dd>
<pre>
  // Delete botvar &quot;color&quot;
  ! var color = undef</pre>
</dd>
<dd>
<pre>
  // An array of color names
  ! array colors = red blue green yellow cyan fuchsia</pre>
</dd>
<dd>
<pre>
  // An array of &quot;can not&quot; variations
  ! array not = can not|would not|should not|could not</pre>
</dd>
<dd>
<pre>
  // A few substitutions
  ! sub can't = can not
  ! sub i'm   = i am</pre>
</dd>
<dd>
<pre>
  // Person substitutions (swaps 1st- and 2nd-person pronouns)
  ! person i   = you
  ! person you = me
  ! person am  = are
  ! person are = am</pre>
</dd>
<dd>
<pre>
  // Add a path to find libraries.
  ! addpath C:/MyRsLibraries</pre>
</dd>
<dd>
<pre>
  // Include some English verb arrays
  ! include English/EngVerbs.rsl</pre>
</dd>
<dd>
<pre>
  // Include a package of objects.
  ! include DateTime.rsp</pre>
</dd>
<dd>
<p><strong>Note:</strong> For arrays with single-word items, separate entries with white spaces. For
multi-word items, use pipe symbols.</p>
</dd>
<dd>
<p><strong>Note:</strong> To delete a variable, set its value to ``undef''</p>
</dd>
<dd>
<p>See also: <a href="#environment_variables">Environment Variables</a> and <a href="#person_substitution">Person Substitution</a>.</p>
</dd>
</li>
<dt><strong><a name="item__3c_and__3e__28label_29"><strong>&lt; and &gt; (Label)</strong></a></strong>

<dd>
<p>The <code>&lt;</code> and <code>&gt;</code> commands are for defining labels. A label is used to treat
a part of code differently. Currently there are three uses for labels: <code>begin</code>, <code>topic</code>,
and <code>object</code>. Example:</p>
</dd>
<dd>
<pre>
  <span class="operator">+</span> <span class="variable">you</span> <span class="variable">are</span> <span class="variable">stupid</span>
  <span class="operator">-</span> <span class="variable">You're</span> <span class="variable">mean</span><span class="operator">.</span> <span class="variable">Apologize</span> <span class="keyword">or</span> <span class="variable">I'm</span> <span class="keyword">not</span> <span class="variable">talking</span> <span class="variable">to</span> <span class="variable">you</span> <span class="variable">again</span><span class="operator">.{</span><span class="variable">topic</span><span class="operator">=</span><span class="variable">apology</span><span class="operator">}</span>
</pre>
</dd>
<dd>
<pre>
  &gt; topic apology</pre>
</dd>
<dd>
<pre>
    + *
    - No, apologize for being so mean to me.</pre>
</dd>
<dd>
<pre>
    <span class="operator">+</span> <span class="variable">sorry</span>
    <span class="operator">-</span> <span class="variable">See</span><span class="operator">,</span> <span class="variable">that</span> <span class="variable">wasn't</span> <span class="variable">too</span> <span class="variable">hard</span><span class="operator">.</span> <span class="variable">I'll</span> <span class="variable">forgive</span> <span class="variable">you</span><span class="operator">.{</span><span class="variable">topic</span><span class="operator">=</span><span class="variable">random</span><span class="operator">}</span>
</pre>
</dd>
<dd>
<pre>
  &lt; topic</pre>
</dd>
</li>
<dt><strong><a name="item__2b__28trigger_29"><strong>+ (Trigger)</strong></a></strong>

<dd>
<p>The <code>+</code> command is the basis for all reply sets. The <code>+</code> command is what the user has
to say to activate the reply set. In the example,</p>
</dd>
<dd>
<pre>
  + hello bot
  - Hello human.</pre>
</dd>
<dd>
<p>The user would say ``hello bot'' and get a ``Hello human.'' reply.</p>
</dd>
<dd>
<p>Triggers are passed through the regexp engine. They should be completely lowercase and
not contain too many foreign characters (use substitutions to format the message any way
you want so you don't need to use foreign characters!)</p>
</dd>
</li>
<dt><strong><a name="item__25__28previous_29"><strong>% (Previous)</strong></a></strong>

<dd>
<p>The <code>%</code> command is for drawing a user back to complete a thought. It's similar to the
<code>&lt;that&gt;</code> functionality in AIML.</p>
</dd>
<dd>
<pre>
  + ask me a question
  - Do you have any pets?</pre>
</dd>
<dd>
<pre>
  + yes
  % do you have any pets
  - What kind of pet?</pre>
</dd>
<dd>
<p>The <code>%</code> command is like the <code>+Trigger</code>, but for the bot's last reply. The same
substitutions are run on the bot's last reply as are run on the user's messages.</p>
</dd>
<dd>
<pre>
  ! sub who's = who is</pre>
</dd>
<dd>
<pre>
  + knock knock
  - Who's there?</pre>
</dd>
<dd>
<pre>
  + *
  % who is *
  - &lt;formal&gt; who?</pre>
</dd>
<dd>
<pre>
  + *
  % * who
  - Haha! &lt;sentence&gt;! That's hilarious!</pre>
</dd>
<dd>
<p>(see <a href="#tags">Tags</a> for details on what <code>&lt;formal&gt;</code> and <code>&lt;sentence&gt;</code> are)</p>
</dd>
</li>
<dt><strong><a name="item__2d__28response_29"><strong>- (Response)</strong></a></strong>

<dd>
<p>The <code>-</code> command is the response to a trigger. The <code>-</code> command has several different
uses, depending on its context. One <code>+Trigger</code> with one <code>-Response</code> makes a one-way
question-and-answer scenario. When multiple <code>-Response</code>s are used, they become random
replies. For more information, see <a href="#complexities_of_the_response">Complexities of the Response</a>.</p>
</dd>
</li>
<dt><strong><a name="item__5e__28continue_29"><strong>^ (Continue)</strong></a></strong>

<dd>
<p>The <code>^</code> command is to extend the data of the previous command. This is for editor-side
use only and has no effect on the brain when replies have all been loaded.</p>
</dd>
<dd>
<p>The following commands can be used with the <code>^Continue</code> command:</p>
</dd>
<dd>
<pre>
  ! global
  ! var
  ! array
  + trigger
  % previous
  - response
  @ redirection</pre>
</dd>
<dd>
<p>Here's an example of extending a very long <code>-Response</code> over multiple lines. When the
brain is tested, the reply will come out as one long string. The <code>^Continue</code> is only
for you, the reply writer, to make it easier to read the code.</p>
</dd>
<dd>
<pre>
  + tell me a poem
  - Little Miss Muffit sat on her tuffet\s
  ^ in a nonchalant sort of way.\s
  ^ With her forcefield around her,\s
  ^ the Spider, the bounder,\s
  ^ is not in the picture today.</pre>
</dd>
<dd>
<p>Note that spaces are NOT assumed between
breaks. You'll need the <a href="#item__5cs"><code>\s</code></a> tag (see <a href="#tags">Tags</a>).</p>
</dd>
</li>
<dt><strong><a name="item__40__28redirect_29"><strong>@ (Redirect)</strong></a></strong>

<dd>
<p>The <code>@</code> command is for directing one trigger to another. For example:</p>
</dd>
<dd>
<pre>
  + my name is *
  - Nice to meet you, &lt;formal&gt;.</pre>
</dd>
<dd>
<pre>
  + people call me *
  @ my name is &lt;star&gt;</pre>
</dd>
<dd>
<pre>
  + i am named *
  @ my name is &lt;star&gt;</pre>
</dd>
</li>
<li><strong><a name="item__28condition_29"><strong>* (Condition)</strong></a></strong>

<p>The <code>*</code> command is for checking conditions. The format is:</p>
<pre>
  * variable = value =&gt; say this</pre>
<p>For an example, you can differentiate between male and female users:</p>
<pre>
  + am i a boy or a girl
  * gender = male   =&gt; You're a boy.
  * gender = female =&gt; You're a girl.
  - You've never told me what you are.</pre>
<p>You can perform the following operations on variable checks:</p>
<pre>
  =  equal to
  != not equal to
  &lt;  less than
  &lt;= less than or equal to
  &gt;  greater than
  &gt;= greater than or equal to
  ?  returns true if the variable is defined</pre>
<p>If you want to check the condition of a bot variable, prepend a <code>#</code> sign to the variable
name. This isn't necessary, but if the user has a variable by the same name, the user's
variable overrides the bot's.</p>
<pre>
  + is your name still soandso
  * #name = Soandso =&gt; That's still my name.
  - No, I changed it.</pre>
<p>Here's an example of the ``defined'' condition:</p>
<pre>
  // Only use the user's name if they've defined it to us
  + hello bot
  * name ? =&gt; Hello there, &lt;get name&gt;, nice to see you again!
  - Hello there!</pre>
</li>
<dt><strong><a name="item__26__28perl_29"><strong>&amp; (Perl)</strong></a></strong>

<dd>
<p>The <code>&amp;</code> command is for executing Perl codes directly from a RiveScript reply set. Use this
only as a last resort, though. RiveScript is powerful enough to handle almost anything you could
want it to, and it can handle these things more securely than this command would, as this command
simply <code>eval</code>s the expression.</p>
</dd>
<dd>
<pre>
  <span class="operator">+</span> <span class="variable">what</span> <span class="variable">is</span> <span class="number">2</span> <span class="variable">plus</span> <span class="number">2</span>
  <span class="operator">-</span> <span class="number">500</span> <span class="variable">Internal</span> <span class="variable">Error</span> <span class="operator">(</span><span class="variable">the</span> <span class="keyword">eval</span> <span class="variable">failed</span> <span class="keyword">for</span> <span class="variable">some</span> <span class="variable">reason</span><span class="operator">!)</span>
  <span class="operator">&amp;</span> <span class="variable">$reply</span> <span class="operator">=</span> <span class="string">'2 + 2 = 4'</span><span class="operator">;</span>
</pre>
</dd>
</li>
<dt><strong><a name="item__2f_2f_or__23__28comments_29"><strong>// <em>or</em> # (Comments)</strong></a></strong>

<dd>
<p>The comment syntax is <code>//</code>, as it is in other scripting languages. Also, <code>/* */</code> comments
can be used to span across multiple lines:</p>
</dd>
<dd>
<pre>
  // A one-line comment</pre>
</dd>
<dd>
<pre>
  /*
    this comment spans
    across multiple lines
  */</pre>
</dd>
<dd>
<p>Commands can be used in-line next to RiveScript commands. They need to have at least one
white space before and after the comment symbols.</p>
</dd>
<dd>
<pre>
  + what color is my (@colors) * // &quot;What color is my green shoe?&quot;
  - Your &lt;star2&gt; is &lt;star1&gt;!     // &quot;Your shoe is green!&quot;</pre>
</dd>
<dd>
<p>The Perl comment symbol, <code>#</code>, can be used in RiveScript as well. It follows the same
principals as the <code>//</code> commands, but it can <strong>not</strong> span across multiple lines.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="rivescript_holds_the_keys">RiveScript Holds The Keys</a></h2>
<p>The RiveScript engine was designed for the RiveScript brain to hold most of the control. As
little programming as possible on the Perl side as possible has made it so that your RiveScript
can define its own variables and handle what it wants to. See <a href="#a_good_brain">A Good Brain</a> for tips on how
to approach this.</p>
<p>
</p>
<h2><a name="complexities_of_the_trigger">Complexities of the Trigger</a></h2>
<p>The <code>+Trigger</code> can be used for more complex things than just simple, 100% dead-on triggers.
This part is passed through a regexp, hence any regexp commands can be used in the trigger...
however, don't think too much into it, you can get impressive results with simple-looking
patterns.</p>
<p><strong>Note:</strong> An asterisk <code>*</code> is always converted into <code>(.*?)</code> regardless of its context. Keep
this in mind.</p>
<dl>
<dt><strong><a name="item_wildcards_3a"><strong>Wildcards:</strong></a></strong>

<dd>
<p>You can write open-ended triggers (called ``wildcard triggers''). You can
capture the output of them, in order, by using the tags <code>&lt;star1&gt;</code> to
<code>&lt;star100&gt;</code>+. Example:</p>
</dd>
<dd>
<pre>
  + my name is *
  - Nice to meet you, &lt;star1&gt;.</pre>
</dd>
</li>
<dt><strong><a name="item_alternations_3a"><strong>Alternations:</strong></a></strong>

<dd>
<p>You can use alternations in the triggers like so:</p>
</dd>
<dd>
<pre>
  + what (s|is) your (home|office|cell) phone number</pre>
</dd>
<dd>
<p>The values the user chose for each set of alternations are also put into the
<code>&lt;star&gt;</code> tags like the wildcards are.</p>
</dd>
</li>
<dt><strong><a name="item_optionals_3a"><strong>Optionals:</strong></a></strong>

<dd>
<p>You can use optional words in a trigger. These words don't have to exist in the user's message
in order to match it, but they can be. Example:</p>
</dd>
<dd>
<pre>
  + what is your [home] phone number
  - You can call me at 555-5555.</pre>
</dd>
<dd>
<p>Alternations can be used inside of optionals as well:</p>
</dd>
<dd>
<pre>
  + what (s|is) your [home|office|cell] phone number</pre>
</dd>
</li>
<dt><strong><a name="item_arrays_3a"><strong>Arrays:</strong></a></strong>

<dd>
<p>This is why it's good to define arrays. Arrays can be used in any number of triggers. Here's
an example of how it works:</p>
</dd>
<dd>
<pre>
  // Make an array of color names
  ! array colors = red blue green yellow cyan fuchsia</pre>
</dd>
<dd>
<pre>
  // Now they can tell us their favorite color!
  + my favorite color is (@colors)
  - Really?! Mine is &lt;star&gt; too!</pre>
</dd>
<dd>
<p>If you want the array choice to be put into a <code>&lt;star&gt;</code> tag, enclose it in parenthesis.
Without the parenthesis, it will be skipped over and not matchible. Example:</p>
</dd>
<dd>
<pre>
  // If the input is &quot;sometimes I am a tool&quot;...</pre>
</dd>
<dd>
<pre>
  ! array be = am are is was were</pre>
</dd>
<dd>
<pre>
  + * i @be *
    // &lt;star1&gt; = 'sometimes'
    // &lt;star2&gt; = 'tool'</pre>
</dd>
<dd>
<pre>
  + * i (@be) *
    // &lt;star1&gt; = 'sometimes'
    // &lt;star2&gt; = 'am'
    // &lt;star3&gt; = 'a tool'</pre>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="complexities_of_the_response">Complexities of the Response</a></h2>
<p>The <code>-Response</code> command has many uses depending on its context:</p>
<dl>
<dt><strong><a name="item_one_2dway_question_2fanswer_3a"><strong>One-way question/answer:</strong></a></strong>

<dd>
<p>A single <code>+</code> and a single <code>-</code> will lead to a one-way question/answer scenario.</p>
</dd>
</li>
<dt><strong><a name="item_random_replies_3a"><strong>Random Replies:</strong></a></strong>

<dd>
<p>A single <code>+</code> with multiple <code>-</code>'s will yield random results from the responses.</p>
</dd>
<dd>
<pre>
  + hello
  - Hey.
  - Hi.
  - Hello.</pre>
</dd>
</li>
<dt><strong><a name="item_fallbacks_3a"><strong>Fallbacks:</strong></a></strong>

<dd>
<p>When using conditionals and Perl codes, you should have at least one <code>-Response</code>
to fall back on in case everything returns false.</p>
</dd>
</li>
<dt><strong><a name="item_weighted_responses_3a"><strong>Weighted Responses:</strong></a></strong>

<dd>
<p>With random replies, you can apply weight to them to improve their probability of
being chosen. All replies have a default weight of 1, and anything lower than 1 can
not be used. Example:</p>
</dd>
<dd>
<pre>
  <span class="operator">+</span> <span class="variable">hello</span>
  <span class="operator">-</span> <span class="variable">Hello</span><span class="operator">,</span> <span class="variable">how</span> <span class="variable">are</span> <span class="variable">you</span><span class="operator">?</span><span class="operator">{</span><span class="variable">weight</span><span class="operator">=</span><span class="number">49</span><span class="operator">}</span>
  <span class="operator">-</span> <span class="variable">Yo</span><span class="operator">,</span> <span class="variable">wazzup</span> <span class="variable">dawg</span><span class="operator">?</span><span class="operator">{</span><span class="variable">weight</span><span class="operator">=</span><span class="number">1</span><span class="operator">}</span>
</pre>
</dd>
<dd>
<p>See <a href="#tags">Tags</a>.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="begin_statement">Begin Statement</a></h2>
<p><strong>The BEGIN file is the first reply file loaded in a loadDirectory call.</strong> If a
``begin.rs'' file exists in the directory being loaded, it is included first. This is
the best place to put your definitions and include statements.</p>
<p><strong>Note:</strong> BEGIN statements are not required.</p>
<p><strong>How to define a BEGIN statement</strong></p>
<pre>
  <span class="operator">&gt;</span> <span class="variable">begin</span>
    <span class="operator">+</span> <span class="variable">request</span>
    <span class="operator">-</span> <span class="operator">{</span><span class="variable">ok</span><span class="operator">}</span>
  <span class="operator">&lt;</span> <span class="variable">begin</span>
</pre>
<p>BEGIN statements are like topics, but are always called first on every reply. If the
response contains <a href="#item__7bok_7d"><code>{ok}</code></a> in it, then the module gets an actual reply to your message
and substitutes it for <a href="#item__7bok_7d"><code>{ok}</code></a>. In this way, the BEGIN statement could format all the
replies in the same way. For an example:</p>
<pre>
  &gt; begin</pre>
<pre>
    <span class="regex">//</span> <span class="variable">Don't</span> <span class="variable">give</span> <span class="variable">a</span> <span class="variable">reply</span> <span class="keyword">if</span> <span class="variable">the</span> <span class="variable">bot</span> <span class="variable">is</span> <span class="variable">down</span> <span class="keyword">for</span> <span class="variable">maintenance</span><span class="operator">.</span> <span class="variable">Else</span><span class="operator">,</span> <span class="variable">sentence</span><span class="operator">-</span><span class="variable">case</span>
    <span class="operator">/</span><span class="regex">/ every reply the bot gives.
    + request
    * #maintenance = yes =&gt; Sorry, the bot is currently deactivated!
    - {sentence}{ok}{/sentence</span><span class="operator">}</span>
</pre>
<pre>
  &lt; begin</pre>
<p>Here is a more complex example using a botvariable ``mood''</p>
<pre>
  <span class="operator">&gt;</span> <span class="variable">begin</span>
    <span class="operator">+</span> <span class="variable">request</span>
    <span class="operator">*</span> <span class="variable">mood</span> <span class="operator">=</span> <span class="string">happy</span>  <span class="operator">=&gt;</span> <span class="operator">{</span><span class="string">ok</span><span class="operator">}</span>
    <span class="operator">*</span> <span class="variable">mood</span> <span class="operator">=</span> <span class="string">sad</span>    <span class="operator">=&gt;</span> <span class="operator">{</span><span class="string">lowercase</span><span class="operator">}{</span><span class="string">ok</span><span class="operator">}{</span><span class="regex">/lowercase}
    * mood = angry  =&gt; {uppercase}{ok}{/uppercase</span><span class="operator">}</span>
    <span class="operator">*</span> <span class="variable">mood</span> <span class="operator">=</span> <span class="string">pissed</span> <span class="operator">=&gt;</span> <span class="operator">{</span><span class="variable">@not</span> <span class="variable">talking</span><span class="operator">}</span>
    <span class="operator">-</span> <span class="operator">{</span><span class="string">ok</span><span class="operator">}</span>
</pre>
<pre>
    + not talking
    - I'm not in a talkative mood.
    - I don't want to talk right now.
  &lt; begin</pre>
<p><strong>Note:</strong> The only trigger that BEGIN receives automatically is <code>request</code>.</p>
<p>
</p>
<h2><a name="topics">Topics</a></h2>
<p>Topics are declared in a similar way to the BEGIN statement. To declare and close a topic,
the syntax is as follows:</p>
<pre>
  &gt; topic NAME
    ...
  &lt; topic</pre>
<p>The topic name should be unique and only one word.</p>
<p><strong>The Default Topic:</strong> The default topic name is ``<code>random</code>''</p>
<p><strong>Setting a Topic:</strong> To set a topic, use the <code>{topic}</code> tag (see <a href="#tags">Tags</a> below).</p>
<pre>
  <span class="operator">+</span> <span class="variable">you</span> <span class="variable">are</span> <span class="variable">stupid</span>
  <span class="operator">-</span> <span class="variable">You're</span> <span class="variable">mean</span><span class="operator">.</span> <span class="variable">Apologize</span> <span class="keyword">or</span> <span class="variable">I'm</span> <span class="keyword">not</span> <span class="variable">talking</span> <span class="variable">to</span> <span class="variable">you</span> <span class="variable">again</span><span class="operator">.{</span><span class="variable">topic</span><span class="operator">=</span><span class="variable">apology</span><span class="operator">}</span>
</pre>
<pre>
  &gt; topic apology</pre>
<pre>
    + *
    - No, apologize for being so mean to me.</pre>
<pre>
    <span class="operator">+</span> <span class="variable">sorry</span>
    <span class="operator">-</span> <span class="variable">See</span><span class="operator">,</span> <span class="variable">that</span> <span class="variable">wasn't</span> <span class="variable">too</span> <span class="variable">hard</span><span class="operator">.</span> <span class="variable">I'll</span> <span class="variable">forgive</span> <span class="variable">you</span><span class="operator">.{</span><span class="variable">topic</span><span class="operator">=</span><span class="variable">random</span><span class="operator">}</span>
</pre>
<pre>
  &lt; topic</pre>
<p>Always set topic back to ``random'' to break out of a topic.</p>
<p>
</p>
<h2><a name="object_macros">Object Macros</a></h2>
<p>Special macros (Perl routines) can be defined and then utilized in your RiveScript code.</p>
<dl>
<dt><strong><a name="item_inline_objects"><strong>Inline Objects</strong></a></strong>

<dd>
<p>You can define objects within your RiveScript code. When doing this, keep in mind that the
object is included as part of the <code>RiveScript::</code> namespace. That being said, here are some
basic tips to follow:</p>
</dd>
<dd>
<pre>
  <span class="number">1</span><span class="operator">)</span> <span class="variable">If</span> <span class="variable">it</span> <span class="variable">uses</span> <span class="variable">any</span> <span class="variable">modules</span><span class="operator">,</span> <span class="variable">they</span> <span class="variable">need</span> <span class="variable">to</span> <span class="variable">be</span> <span class="variable">explicitely</span> <span class="variable">declared</span> <span class="variable">with</span> <span class="variable">a</span> <span class="string">'use'</span> <span class="variable">statement</span><span class="operator">.</span>
  <span class="number">2</span><span class="operator">)</span> <span class="variable">If</span> <span class="variable">it</span> <span class="variable">refers</span> <span class="variable">to</span> <span class="variable">any</span> <span class="variable">variables</span> <span class="variable">global</span> <span class="variable">to</span> <span class="variable">your</span> <span class="variable">main</span> <span class="variable">script</span><span class="operator">,</span> <span class="string">'main::'</span> <span class="variable">must</span> <span class="variable">be</span> <span class="variable">prepended</span><span class="operator">.</span>
     <span class="variable">Example</span><span class="operator">:</span> <span class="string">'$main::hashref-&gt;{key}'</span>
  <span class="number">3</span><span class="operator">)</span> <span class="variable">If</span> <span class="variable">it</span> <span class="variable">refers</span> <span class="variable">to</span> <span class="variable">any</span> <span class="variable">subroutine</span> <span class="variable">of</span> <span class="variable">your</span> <span class="variable">main</span> <span class="variable">program</span><span class="operator">,</span> <span class="string">'main::'</span> <span class="variable">must</span> <span class="variable">be</span> <span class="variable">prepended</span><span class="operator">.</span>
     <span class="variable">Example</span><span class="operator">:</span> <span class="string">'&amp;main::reload()'</span>
</pre>
</dd>
<dd>
<p>Here's a full example of an object:</p>
</dd>
<dd>
<pre>
  + give me a fortune cookie
  - Your random fortune cookie: &amp;fortune.get()</pre>
</dd>
<dd>
<pre>
  <span class="operator">&gt;</span> <span class="variable">object</span> <span class="variable">fortune</span>
    <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$method</span><span class="operator">,</span><span class="variable">$msg</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
</pre>
</dd>
<dd>
<pre>
    <span class="keyword">my</span> <span class="variable">@cookies</span> <span class="operator">=</span> <span class="operator">(</span>
      <span class="string">'You will be rich and famous'</span><span class="operator">,</span>
      <span class="string">'You will meet a celebrity'</span><span class="operator">,</span>
      <span class="string">'You will go to the moon'</span><span class="operator">,</span>
    <span class="operator">);</span>
</pre>
</dd>
<dd>
<pre>
    <span class="keyword">return</span> <span class="variable">$cookies</span> <span class="operator">[</span> <span class="keyword">int</span><span class="operator">(</span><span class="keyword">rand</span><span class="operator">(</span><span class="keyword">scalar</span><span class="operator">(</span><span class="variable">@cookies</span><span class="operator">)))</span> <span class="operator">]</span><span class="operator">;</span>
      <span class="operator">&lt;</span> <span class="variable">object</span>
</pre>
</dd>
</li>
<dt><strong><a name="item_define_an_object_from_perl"><strong>Define an Object from Perl</strong></a></strong>

<dd>
<p>This is done like so:</p>
</dd>
<dd>
<pre>
  <span class="comment"># Define a weather lookup macro.</span>
  <span class="variable">$rivescript</span><span class="operator">-&gt;</span><span class="variable">setSubroutine</span> <span class="operator">(</span><span class="string">weather</span> <span class="operator">=&gt;</span> <span class="operator">\&amp;</span><span class="variable">weather_lookup</span><span class="operator">);</span>
</pre>
</dd>
</li>
<dt><strong><a name="item_call_an_object"><strong>Call an Object</strong></a></strong>

<dd>
<p>To call on an object inside of a reply, the format is:</p>
</dd>
<dd>
<pre>
  &amp;object_name.method_name(argument)</pre>
</dd>
<dd>
<p>All objects receive <code>$method</code> (the data after the dot) and <code>$argument</code> (the data inside
the parenthesis). Here's another example:</p>
</dd>
<dd>
<pre>
  + encode * in base64
  - &amp;encode.base64(&lt;star&gt;)</pre>
</dd>
<dd>
<pre>
  + encode * in md5
  - &amp;encode.md5(&lt;star&gt;)</pre>
</dd>
<dd>
<pre>
  <span class="operator">&gt;</span> <span class="variable">object</span> <span class="variable">encode</span>
    <span class="keyword">my</span> <span class="operator">(</span><span class="variable">$method</span><span class="operator">,</span><span class="variable">$data</span><span class="operator">)</span> <span class="operator">=</span> <span class="variable">@_</span><span class="operator">;</span>
</pre>
</dd>
<dd>
<pre>
    <span class="keyword">use</span> <span class="variable">MIME::Base64</span> <span class="string">qw(encode_base64)</span><span class="operator">;</span>
    <span class="keyword">use</span> <span class="variable">Digest::MD5</span> <span class="string">qw(md5_hex)</span><span class="operator">;</span>
</pre>
</dd>
<dd>
<pre>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">$method</span> <span class="keyword">eq</span> <span class="string">'base64'</span><span class="operator">)</span> <span class="operator">{</span>
      <span class="keyword">return</span> <span class="variable">encode_base64</span> <span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
    <span class="operator">}</span>
    <span class="keyword">else</span> <span class="operator">{</span>
      <span class="keyword">return</span> <span class="variable">md5_hex</span> <span class="operator">(</span><span class="variable">$data</span><span class="operator">);</span>
    <span class="operator">}</span>
      <span class="operator">&lt;</span> <span class="variable">object</span>
</pre>
</dd>
<dd>
<p><strong>Note:</strong> If an object does not exist, has faulty code, or does not return a reply, the contents
of global <code>macro_failure</code> will be inserted instead. The module cannot tell you which of the
three errors is the cause, though.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="tags">Tags</a></h2>
<p>Special tags can be inserted into RiveScript replies. The tags are as follows:</p>
<dl>
<dt><strong><a name="item__3cstar_3e_2c__3cstar1_3e__2d__3cstar100_3e_2b"><strong>&lt;star&gt;, &lt;star1&gt; - &lt;star100&gt;+</strong></a></strong>

<dd>
<p>These tags will insert the values of <code>$1</code> to <code>$100</code>+, as matched in the trigger regexp.
<code>&lt;star&gt;</code> is an alias for <code>&lt;star1&gt;</code>.</p>
</dd>
</li>
<dt><strong><a name="item__3cinput1_3e__2d__3cinput9_3e_2c__3creply1_3e__2d_"><strong>&lt;input1&gt; - &lt;input9&gt;, &lt;reply1&gt; - &lt;reply9&gt;</strong></a></strong>

<dd>
<p>Inserts the last 1 to 9 things the user said, and the last 1 to 9 things the bot replied
with, respectively.</p>
</dd>
</li>
<dt>
<dd>
<p>Inserts the user's ID.</p>
</dd>
</li>
<dt>
<dd>
<p>Insert a bot variable (defined with <code>! var</code>).</p>
</dd>
<dd>
<pre>
  + what is your name
  - I am &lt;bot name&gt;, created by &lt;bot author&gt;.</pre>
</dd>
<dd>
<p>This is also the only tag that can be used in triggers.</p>
</dd>
<dd>
<pre>
  + my name is &lt;bot name&gt;
  - &lt;set name=&lt;bot name&gt;&gt;What a coincidence, that's my name too!</pre>
</dd>
</li>
<dt><strong><a name="item__3cget_3e_2c__3cset_3e"><strong>&lt;get&gt;, &lt;set&gt;</strong></a></strong>

<dd>
<p>Get and set a user variable. These are local variables for the current user.</p>
</dd>
<dd>
<pre>
  + my name is *
  - &lt;set name=&lt;formal&gt;&gt;Nice to meet you, &lt;get name&gt;!</pre>
</dd>
<dd>
<pre>
  + who am i
  - You are &lt;get name&gt; aren't you?</pre>
</dd>
</li>
<dt><strong><a name="item__3cadd_3e_2c__3csub_3e_2c__3cmult_3e_2c__3cdiv_3e"><strong>&lt;add&gt;, &lt;sub&gt;, &lt;mult&gt;, &lt;div&gt;</strong></a></strong>

<dd>
<p>Add, subtract, multiple and divide numeric variables, respectively.</p>
</dd>
<dd>
<pre>
  + give me 5 points
  - &lt;add points=5&gt;You have receive 5 points and now have &lt;get points&gt; total.</pre>
</dd>
<dd>
<p>If the variable is undefined, it is set to 0 before the math is done on it. If you try
to modify a defined, but not numeric, variable (such as ``name'') then <strong>(Var=NaN)</strong> is
inserted in place of this tag.</p>
</dd>
<dd>
<p>Likewise, if you modify a variable with a non-numeric value, then <strong>(Value=NaN)</strong> is
inserted.</p>
</dd>
</li>
<dt><strong><a name="item__7btopic_3d_2e_2e_2e_7d"><strong>{topic=...}</strong></a></strong>

<dd>
<p>This will change the user's topic. See <a href="#topics">Topics</a>.</p>
</dd>
</li>
<dt><strong><a name="item__7bnextreply_7d"><strong>{nextreply}</strong></a></strong>

<dd>
<p>Breaks the reply into two parts here. This will cause <a href="#item_reply"><code>reply()</code></a> to return multiple
responses for each side of the <a href="#item__7bnextreply_7d"><code>{nextreply}</code></a> tag.</p>
</dd>
</li>
<dt><strong><a name="item__7bweight_3d_2e_2e_2e_7d"><strong>{weight=...}</strong></a></strong>

<dd>
<p>Add some weight to a <code>-Response</code>. See <a href="#complexities_of_the_response">Complexities of the Response</a>.</p>
</dd>
</li>
<dt><strong><a name="item__7b_40_2e_2e_2e_7d_2c__3c_40_3e"><strong>{@...}, &lt;@&gt;</strong></a></strong>

<dd>
<p>An inline redirection. These work like normal redirections but can be inserted into another
reply.</p>
</dd>
<dd>
<pre>
  <span class="operator">+</span> <span class="operator">*</span> <span class="keyword">or</span> <span class="variable">something</span>
  <span class="operator">-</span> <span class="variable">Or</span> <span class="variable">something</span><span class="operator">.</span> <span class="operator">{</span><span class="variable">@&lt;</span><span class="variable">star</span><span class="operator">&gt;}</span>
</pre>
</dd>
<dd>
<p><code>&lt;@&gt;</code> is an alias for <code>{@&lt;star&gt;}</code></p>
</dd>
</li>
<dt><strong><a name="item__7b_21_2e_2e_2e_7d"><strong>{!...}</strong></a></strong>

<dd>
<p>An inline definition.</p>
</dd>
</li>
<dt><strong><a name="item__7brandom_7d_2e_2e_2e_7b_2frandom_7d"><strong>{random}...{/random}</strong></a></strong>

<dd>
<p>Inserts a random bit of text. Separate single-word items with spaces or multi-word items
with pipes.</p>
</dd>
<dd>
<pre>
  <span class="operator">+</span> <span class="variable">test</span> <span class="variable">random</span>
  <span class="operator">-</span> <span class="variable">This</span> <span class="operator">{</span><span class="variable">random</span><span class="operator">}</span><span class="variable">reply</span> <span class="variable">response</span><span class="operator">{</span><span class="regex">/random} has random {random}bits of text|pieces of data{/random</span><span class="operator">}.</span>
</pre>
</dd>
</li>
<dt><strong><a name="item__7bperson_7d_2e_2e_2e_7b_2fperson_7d_2c__3cperson_"><strong>{person}...{/person}, &lt;person&gt;</strong></a></strong>

<dd>
<p>Will take the enclosed text and run person substitutions on them. See <a href="#person_substitution">Person Substitution</a>.</p>
</dd>
<dd>
<p><code>&lt;person&gt;</code> is an alias for <code>{person}&lt;star&gt;{/person}</code></p>
</dd>
</li>
<dt><strong><a name="item__7bformal_7d_2e_2e_2e_7b_2fformal_7d_2c__3cformal_"><strong>{formal}...{/formal}, &lt;formal&gt;</strong></a></strong>

<dd>
<p>Will Make Your Text Formal.</p>
</dd>
<dd>
<p><code>&lt;formal&gt;</code> is an alias for <code>{formal}&lt;star&gt;{/formal}</code></p>
</dd>
</li>
<dt><strong><a name="item__7bsentence_7d_2e_2e_2e_7b_2fsentence_7d_2c__3csen"><strong>{sentence}...{/sentence}, &lt;sentence&gt;</strong></a></strong>

<dd>
<p>Will make your text sentence-cased.</p>
</dd>
<dd>
<p><code>&lt;sentence&gt;</code> is an alias for <code>{sentence}&lt;star&gt;{/sentence}</code></p>
</dd>
</li>
<dt><strong><a name="item__7buppercase_7d_2e_2e_2e_7b_2fuppercase_7d_2c__3cu"><strong>{uppercase}...{/uppercase}, &lt;uppercase&gt;</strong></a></strong>

<dd>
<p>WILL MAKE THE TEXT UPPERCASE.</p>
</dd>
<dd>
<p><code>&lt;uppercase&gt;</code> is an alias for <code>{uppercase}&lt;star&gt;{/uppercase}</code></p>
</dd>
</li>
<dt><strong><a name="item__7blowercase_7d_2e_2e_2e_7b_2flowercase_7d_2c__3cl"><strong>{lowercase}...{/lowercase}, &lt;lowercase&gt;</strong></a></strong>

<dd>
<p>will make the text lowercase.</p>
</dd>
<dd>
<p><code>&lt;lowercase&gt;</code> is an alias for <code>{lowercase}&lt;star&gt;{/lowercase}</code></p>
</dd>
</li>
<dt><strong><a name="item__7bok_7d"><strong>{ok}</strong></a></strong>

<dd>
<p>This is used only with the <a href="#begin_statement">Begin Statement</a>. It tells the interpreter that it's okay to
get a reply.</p>
</dd>
</li>
<dt><strong><a name="item__5cs"><strong>\s</strong></a></strong>

<dd>
<p>Inserts a white space.</p>
</dd>
</li>
<dt><strong><a name="item__5cn"><strong>\n</strong></a></strong>

<dd>
<p>Inserts a newline.</p>
</dd>
</li>
<dt><strong><a name="item__5c_2f"><strong>\/</strong></a></strong>

<dd>
<p>Insert a forward slash. This is to include forward slashes without them being interpreted
as comments.</p>
</dd>
</li>
<dt><strong><a name="item__5c_23"><strong>\#</strong></a></strong>

<dd>
<p>Inserts a pound symbol. This is to include pound symbols without them being interpreted
as comments.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="environment_variables">Environment Variables</a></h2>
<p>Environment variables are kept as ``botvariables'' and can be retrieved with the
<code>&lt;bot&gt;</code> tags. The variable names are all uppercase and begin with ``ENV_''</p>
<dl>
<dt><strong><a name="item_rivescript_environment_variables"><strong>RiveScript Environment Variables</strong></a></strong>

<dd>
<pre>
  ENV_OS          = The operating system RiveScript is running on.
  ENV_APPVERSION  = The version of RiveScript being used.
  ENV_APPNAME     = A user-agent style string (&quot;RiveScript/1.00&quot;)
  ENV_REPLY_COUNT = The number of loaded triggers.</pre>
</dd>
<dt><strong><a name="item_perl_environment_variables"><strong>Perl Environment Variables</strong></a></strong>

<dd>
<p>All Perl variables are prepended with ``ENV_SYS_'', so that ``ENV_SYS_REMOTE_ADDR'' would
contain the user's IP address if RiveScript was used via HTTP CGI.</p>
</dd>
</li>
<dt><strong><a name="item_setting_environment_variables"><strong>Setting Environment Variables</strong></a></strong>

<dd>
<p>RiveScript's syntax prohibits the modification of environment variables through any
loaded RiveScript document. However, you can call the method <a href="#item_setvariable"><code>setVariable()</code></a> to
change environment variables from the Perl side if need-be.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="person_substitution">Person Substitution</a></h2>
<p>The <code>{person}</code> tag can be used to perform substitutions between 1st- and 2nd-person
pronouns.</p>
<p>You can define these with the <code>!define</code> tag:</p>
<pre>
  ! person i     = you
  ! person my    = your
  ! person mine  = yours
  ! person me    = you
  ! person am    = are
  ! person you   = I
  ! person your  = my
  ! person yours = mine
  ! person are   = am</pre>
<p>Then use the <code>{person}</code> tag in a response. The enclosed text will swap these pronouns.</p>
<pre>
  + do you think *
  - What if I do think {person}&lt;star&gt;{/person}?</pre>
<pre>
  &quot;Do you think I am a bad person?&quot;
  &quot;What if I do think you are a bad person?&quot;</pre>
<p>Without the person tags, it would say ``What if I do think I am a bad person?'' and not make very
much sense.</p>
<p><strong>Note:</strong> RiveScript does not assume any pre-set substitutions. You must define them in your own
brains.</p>
<p>
</p>
<h2><a name="dynamic_replies">Dynamic Replies</a></h2>
<p>Here is an overview of the internal hashref structure of the RiveScript object, for modifying
replies directly.</p>
<dl>
<dt><strong><a name="item__rs__replies_"><strong>$rs-&gt;{replies}</strong></a></strong>

<dd>
<p>This hashref contains all of the replies. The first keys are the topic name, then the trigger
texts under that topic.</p>
</dd>
<dd>
<p>So, <strong>$rs-&gt;{replies}-&gt;{random}</strong> contains all triggers for the default topic.</p>
</dd>
<dd>
<p><strong>$rs-</strong>{replies}-&gt;{random}-&gt;{'my favorite color is (@colors) *'}&gt; would be the location of a
specific trigger.</p>
</dd>
</li>
<dt><strong><a name="item_trigger_sub_2dkeys"><strong>Trigger Sub-Keys</strong></a></strong>

<dd>
<p>The following keys are underneath a trigger key (<strong>$rs-</strong>{replies}-&gt;{$topic}-&gt;{$trigger}&gt;)</p>
</dd>
<dd>
<p><strong>1..n</strong> - The <code>-Responses</code> under the trigger, in order.</p>
</dd>
<dd>
<p><strong>redirect</strong> - The contents of the <code>@Redirect</code> if applicable.</p>
</dd>
<dd>
<p><strong>conditions-</strong>{1..n}&gt; - The data from the <code>*Condition</code> commands, in order.</p>
</dd>
<dd>
<p><strong>system-</strong>{codes}&gt; - The contents of any <code>&amp;Perl</code> codes if applicable.</p>
</dd>
</li>
<dt><strong><a name="item_examples"><strong>Examples</strong></a></strong>

<dd>
<pre>
  // RiveScript Code
  + my name is *
  - &lt;star&gt;, nice to meet you!
  - Nice to meet you, &lt;star&gt;.</pre>
</dd>
<dd>
<pre>
  <span class="comment"># Perl code. Get the value of the second reply.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">replies</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">random</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">'my name is *'</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="number">2</span><span class="operator">}</span>
</pre>
</dd>
<dd>
<pre>
  // RiveScript Code
  &gt; topic favorites
    + *(@colors)*
    - I like &lt;star2&gt; too. :-)
    &amp; &amp;main::log('&lt;id&gt; likes &lt;star2&gt;')
  &lt; topic</pre>
</dd>
<dd>
<pre>
  <span class="comment"># Perl code. Get the perl data from that trigger.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">replies</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">favorites</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">'*(@colors)*'</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">system</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">codes</span><span class="operator">}</span>
</pre>
</dd>
<dd>
<pre>
  // RiveScript Code
  + *
  % whos there
  - &lt;star&gt; who?</pre>
</dd>
<dd>
<pre>
  <span class="comment"># Perl code. Access this one's reply.</span>
  <span class="variable">$rs</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">replies</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">'__that__whos there'</span><span class="operator">}</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="number">1</span><span class="operator">}</span>
</pre>
</dd>
</dl>
<p>
</p>
<h2><a name="included_files">Included Files</a></h2>
<p><strong>Recommended practice</strong> is to place all your <code>!include</code> statements inside your begin.rs file,
as this file is always loaded in first.</p>
<dl>
<dt><strong><a name="item_rivescript_libraries"><strong>RiveScript Libraries</strong></a></strong>

<dd>
<p>RiveScript Libraries (<strong>.rsl</strong> extension) are special RiveScript documents that are generally
full of arrays and substitutions. For instance, the RiveScript distribution comes with English.rsl
which is full of English nouns, verbs, and adjectives.</p>
</dd>
</li>
<dt><strong><a name="item_rivescript_packages"><strong>RiveScript Packages</strong></a></strong>

<dd>
<p>RiveScript Packages (<strong>.rsp</strong> extension) are special RiveScript documents that are generally
full of objects. The RiveScript distribution comes with DateTime.rsp, which has an object for
returning time stamps.</p>
</dd>
</li>
<dt><strong><a name="item_rivescript_include_search_path"><strong>RiveScript Include Search Path</strong></a></strong>

<dd>
<p>The default RiveScript Includes search path is the array of Perl's <code>@INC</code>, with ``/RiveScript''
tacked on to the end of it. Also, the working directory of your script is included in this.</p>
</dd>
<dd>
<p>You can use the <code>!addpath</code> directive to add new search paths.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="reserved_variables">Reserved Variables</a></h2>
<p>The following are all the reserved variables within RiveScript which cannot be (re)set by
your reply files.</p>
<dl>
<dt><strong><a name="item_reserved_global_variables"><strong>Reserved Global Variables</strong></a></strong>

<dd>
<p>These variables can't be overwritten with the <code>!global</code> command:</p>
</dd>
<dd>
<pre>
  reserved replies array syntax streamcache botvars uservars
  botarrays sort users substitutions</pre>
</dd>
</li>
<dt><strong><a name="item_reserved_topic_names"><strong>Reserved Topic Names</strong></a></strong>

<dd>
<p>The following topic names are special and should never be (re)created in your RiveScript files.</p>
</dd>
<dd>
<pre>
  __begin__  (used for the BEGIN statement)
  __that__*  (used for the %Previous command)</pre>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="a_good_brain">A Good Brain</a></h2>
<p>Since RiveScript leaves a lot of control up to the brain and not the Perl code, here are some
general tips to follow when writing your own brain:</p>
<dl>
<dt><strong><a name="item_make_a_config_file_2e"><strong>Make a config file.</strong></a></strong>

<dd>
<p>This would probably be named ``config.rs'' and it would handle all
your definitions. For example it might look like this:</p>
</dd>
<dd>
<pre>
  // Set up globals
  ! global debug = 0
  ! global split_sentences = 1
  ! global sentence_splitters = . ! ; ?</pre>
</dd>
<dd>
<pre>
  // Set a variable to say that we're active.
  ! var active = yes</pre>
</dd>
<dd>
<pre>
  // Set up botvariables
  ! var botname = Rive
  ! var botage = 5
  ! var company = AiChaos Inc.
  // note that &quot;bot&quot; isn't required in these variables,
  // it's only there for readibility</pre>
</dd>
<dd>
<pre>
  // Set up substitutions
  ! sub won't = will not
  ! sub i'm = i am
  // etc</pre>
</dd>
<dd>
<pre>
  // Set up arrays
  ! array colors = red green blue yellow cyan fuchsia ...</pre>
</dd>
<dd>
<p>Here are a list of all the globals you might want to configure.</p>
</dd>
<dd>
<pre>
  split_sentences    - Whether to do sentence-splitting (1 or 0, default 1)
  sentence_splitters - Where to split sentences at. Separate items with a single
                       space. The defaults are:   ! . ? ;
  macro_failure      - Text to be inserted into a bot's reply when a macro fails
                       to run (or return a reply).
  debug              - Debug mode (1 or 0, default 0)</pre>
</dd>
</li>
<dt><strong><a name="item_make_a_begin_file_2e"><strong>Make a begin file.</strong></a></strong>

<dd>
<p>Create a file called ``begin.rs'' -- there are several reasons for doing so.</p>
</dd>
<dd>
<p>For one, you should use this file for <code>!include</code> statements if you want your brain
to use some common libraries or packages. Secondly, you can use the <strong>&lt;BEGIN</strong> statement
to setup a handler for incoming messages.</p>
</dd>
<dd>
<p>Your begin file could check the ``active'' variable we set in the config file to decide if it should give a reply.</p>
</dd>
<dd>
<pre>
  <span class="operator">&gt;</span> <span class="variable">begin</span>
    <span class="operator">+</span> <span class="variable">request</span>
    <span class="operator">*</span> <span class="variable">active</span><span class="operator">=</span><span class="string">no</span> <span class="operator">=&gt;</span> <span class="variable">Sorry</span> <span class="variable">but</span> <span class="variable">I'm</span> <span class="variable">deactivated</span> <span class="variable">right</span> <span class="variable">now</span><span class="operator">!</span>
    <span class="operator">-</span> <span class="operator">{</span><span class="variable">ok</span><span class="operator">}</span>
  <span class="operator">&lt;</span> <span class="variable">begin</span>
</pre>
</dd>
<dd>
<p>These are the basic tips, just for organizational purposes.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="see_other">SEE OTHER</a></h1>
<p><a href="/RiveScript/Parser.html">the RiveScript::Parser manpage</a> - Reading and Writing of RiveScript Documents.</p>
<p><a href="/RiveScript/Brain.html">the RiveScript::Brain manpage</a> - The reply and search methods of RiveScript.</p>
<p><a href="/RiveScript/Util.html">the RiveScript::Util manpage</a> - String utilities for RiveScript.</p>
<p>
</p>
<hr />
<h1><a name="changes">CHANGES</a></h1>
<pre>
  Version 1.00
  - Public stable beta release.</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">21</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="operator">\</span><span class="variable">u</span> <span class="variable">tag</span> <span class="keyword">for</span> <span class="variable">inserting</span> <span class="variable">an</span> <span class="string">"undefined"</span> <span class="variable">character</span> <span class="operator">(</span><span class="variable">i</span><span class="operator">.</span><span class="variable">e</span><span class="operator">.</span> <span class="variable">set</span> <span class="variable">global</span> <span class="variable">macro_failure</span>
    <span class="variable">to</span> <span class="operator">\</span><span class="variable">u</span> <span class="variable">to</span> <span class="variable">remove</span> <span class="variable">macro</span> <span class="variable">failure</span> <span class="variable">notifications</span> <span class="variable">altogether</span> <span class="variable">from</span> <span class="variable">the</span> <span class="variable">responses</span><span class="operator">)</span>
  <span class="operator">-</span> <span class="variable">The</span> <span class="variable">code</span> <span class="variable">to</span> <span class="variable">run</span> <span class="variable">objects</span> <span class="variable">is</span> <span class="variable">now</span> <span class="variable">run</span> <span class="keyword">last</span> <span class="variable">in</span> <span class="variable">RiveScript::Util::tagFilter</span><span class="operator">,</span> <span class="variable">so</span> <span class="variable">that</span> <span class="variable">other</span>
    <span class="variable">tags</span> <span class="variable">such</span> <span class="variable">as</span> <span class="operator">{</span><span class="variable">random</span><span class="operator">},</span> <span class="operator">&lt;</span><span class="variable">get</span><span class="operator">&gt;,</span> <span class="variable">etc</span><span class="operator">.</span> <span class="variable">are</span> <span class="variable">all</span> <span class="variable">run</span> <span class="variable">before</span> <span class="variable">the</span> <span class="variable">object</span> <span class="variable">is</span> <span class="variable">executed</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Two</span> <span class="variable">new</span> <span class="variable">standard</span> <span class="variable">libraries</span> <span class="variable">have</span> <span class="variable">been</span> <span class="variable">added</span><span class="operator">:</span>
    <span class="operator">-</span> <span class="variable">Colors</span><span class="operator">.</span><span class="variable">rsl</span> <span class="operator">-</span> <span class="variable">Arrays</span> <span class="keyword">for</span> <span class="variable">color</span> <span class="variable">names</span>
    <span class="operator">-</span> <span class="variable">Numbers</span><span class="operator">.</span><span class="variable">rsl</span> <span class="operator">-</span> <span class="variable">Arrays</span> <span class="keyword">for</span> <span class="variable">number</span> <span class="variable">names</span>
</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">20</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="variable">shortcut</span> <span class="variable">tags</span><span class="operator">:</span> <span class="operator">&lt;</span><span class="variable">person</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">@&gt;</span><span class="operator">,</span> <span class="operator">&lt;</span><span class="variable">formal</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">sentence</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">uppercase</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">lowercase</span><span class="operator">&gt;,</span>
    <span class="keyword">for</span> <span class="variable">running</span> <span class="variable">the</span> <span class="variable">respective</span> <span class="variable">tags</span> <span class="variable">on</span> <span class="operator">&lt;</span><span class="variable">star</span><span class="operator">&gt;</span> <span class="operator">(</span><span class="variable">i</span><span class="operator">.</span><span class="variable">e</span><span class="operator">.</span> <span class="operator">&lt;</span><span class="variable">person</span><span class="operator">&gt;</span> <span class="operator">==&gt;</span> <span class="operator">{</span><span class="string">person</span><span class="operator">}</span><span class="operator">&lt;</span><span class="variable">star</span><span class="operator">&gt;{</span><span class="regex">/person})
  - Added environment variable ENV_REPLY_COUNT which holds the number of loaded triggers.
  - Bugfix: sending scalar=&gt;0 to reply() was returning the scalar of the array of replies,
    not the array itself. This has been fixed.
  </span>
</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">19</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="variable">methods</span> <span class="keyword">for</span> <span class="variable">allowing</span> <span class="keyword">or</span> <span class="variable">denying</span> <span class="variable">certain</span> <span class="variable">commands</span> <span class="variable">to</span> <span class="variable">be</span> <span class="variable">used</span> <span class="variable">when</span> <span class="variable">RiveScript</span>
    <span class="variable">documents</span> <span class="variable">are</span> <span class="variable">loaded</span> <span class="variable">in</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Bugfix</span><span class="operator">:</span> <span class="variable">the</span> <span class="variable">sortThats</span><span class="operator">()</span> <span class="variable">method</span> <span class="variable">of</span> <span class="variable">RiveScript::Parser</span> <span class="variable">was</span> <span class="variable">blanking</span> <span class="variable">out</span> <span class="variable">the</span> <span class="variable">current</span>
    <span class="variable">value</span> <span class="variable">of</span> <span class="variable">$self</span><span class="operator">-&gt;</span><span class="operator">{</span><span class="string">thatarray</span><span class="operator">}</span> <span class="operator">--</span> <span class="variable">meaning</span><span class="operator">,</span> <span class="variable">the</span> <span class="keyword">last</span> <span class="variable">file</span> <span class="variable">to</span> <span class="variable">have</span> <span class="variable">%Previous</span> <span class="variable">commands</span> <span class="variable">used</span>
    <span class="variable">would</span> <span class="variable">be</span> <span class="variable">kept</span> <span class="variable">in</span> <span class="variable">memory</span><span class="operator">,</span> <span class="variable">previous</span> <span class="variable">ones</span> <span class="variable">would</span> <span class="variable">be</span> <span class="variable">lost</span><span class="operator">.</span> <span class="variable">This</span> <span class="variable">has</span> <span class="variable">been</span> <span class="variable">fixed</span> <span class="variable">now</span><span class="operator">.</span>
</pre>
<pre>
  Version 0.18
  - Minor bugfix with the &quot;%PREVIOUS&quot; internal array.</pre>
<pre>
  Version 0.17
  - All the &quot;%PREVIOUS&quot; commands found at loading time are now sorted in an internal
    arrayref, in the same manner that &quot;+TRIGGERS&quot; are. This solves the bug with
    matchability when using several %PREVIOUS commands in your replies.
  - Added the # command as a &quot;Perly&quot; alternative to // comments.
  - Comments can be used in-line next to normal RiveScript code, requiring that at
    least one space exist before and after the comment symbols. You can escape the
    symbols too if you need them in the reply.
  - Created a new package DateTime.rsp for your timestamp-formatting needs.</pre>
<pre>
  Version 0.16
  - Added &quot;! syslib&quot; directive for including Perl modules at the RiveScript:: level,
    to save on memory usage when more than one object might want the same module.
  - The &quot;%PREVIOUS&quot; directive now takes a regexp. The bot's last reply is saved as-is,
    not formatted to lowercase. The % command now works like a +Trigger for the bot's
    last reply.
  - The &quot;%PREVIOUS&quot; directive check has been moved to another subroutine. In this way,
    its priority is much higher. A trigger of * (catch-all) with a %PREVIOUS will always
    match, for example.
  - Fixed a bug with the BEGIN method. The bot's reply is no longer saved while the
    topic is __begin__ - this messed up the %THAT directive.</pre>
<pre>
  Version 0.15
  - Broke RiveScript into multiple sub-modules.</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">14</span>
  <span class="operator">-</span> <span class="operator">{</span><span class="variable">formal</span><span class="operator">}</span> <span class="keyword">and</span> <span class="operator">{</span><span class="variable">sentence</span><span class="operator">}</span> <span class="variable">tags</span> <span class="variable">fixed</span><span class="operator">.</span> <span class="variable">They</span> <span class="variable">both</span> <span class="keyword">use</span> <span class="variable">regexp's</span> <span class="variable">now</span><span class="operator">.</span> <span class="operator">{</span><span class="variable">sentence</span><span class="operator">}</span> <span class="variable">can</span>
    <span class="variable">take</span> <span class="variable">multiple</span> <span class="variable">sentences</span> <span class="variable">with</span> <span class="keyword">no</span> <span class="variable">problem</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">In</span> <span class="variable">a</span> <span class="keyword">BEGIN</span> <span class="variable">statement</span><span class="operator">,</span> <span class="operator">{</span><span class="string">topic</span><span class="operator">}</span> <span class="variable">tags</span> <span class="variable">are</span> <span class="variable">handled</span> <span class="variable">first</span><span class="operator">.</span> <span class="variable">In</span> <span class="variable">this</span> <span class="variable">way</span><span class="operator">,</span> <span class="variable">the</span> <span class="keyword">BEGIN</span>
    <span class="variable">statement</span> <span class="variable">can</span> <span class="variable">force</span> <span class="variable">a</span> <span class="variable">topic</span> <span class="variable">before</span> <span class="variable">getting</span> <span class="variable">a</span> <span class="variable">reply</span> <span class="variable">under</span> <span class="variable">the</span> <span class="variable">user's</span> <span class="variable">current</span> <span class="variable">topic</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Fixed</span> <span class="variable">a</span> <span class="variable">bug</span> <span class="variable">with</span> <span class="string">"blank"</span> <span class="variable">commands</span> <span class="keyword">while</span> <span class="variable">reading</span> <span class="variable">in</span> <span class="variable">a</span> <span class="variable">file</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Fixed</span> <span class="variable">a</span> <span class="variable">bug</span> <span class="variable">with</span> <span class="variable">the</span> <span class="variable">RiveScriptLib</span> <span class="variable">Search</span> <span class="variable">Paths</span><span class="operator">.</span>
</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">13</span>
  <span class="operator">-</span> <span class="variable">The</span> <span class="keyword">BEGIN</span><span class="operator">/</span><span class="variable">request</span> <span class="variable">statement</span> <span class="variable">has</span> <span class="variable">been</span> <span class="variable">changed</span><span class="operator">.</span> <span class="variable">The</span> <span class="variable">user</span> <span class="variable">that</span> <span class="variable">makes</span> <span class="variable">the</span> <span class="string">"request"</span>
    <span class="variable">is</span> <span class="variable">the</span> <span class="variable">actual</span> <span class="variable">user</span><span class="operator">--</span><span class="keyword">no</span> <span class="variable">longer</span> <span class="string">"__rivescript__"</span><span class="operator">,</span> <span class="variable">so</span> <span class="variable">user</span><span class="operator">-</span><span class="variable">based</span> <span class="variable">conditionals</span> <span class="variable">can</span>
    <span class="variable">work</span> <span class="variable">too</span><span class="operator">.</span> <span class="variable">Also</span><span class="operator">,</span> <span class="variable">request</span> <span class="variable">tags</span> <span class="variable">are</span> <span class="keyword">not</span> <span class="variable">processed</span> <span class="keyword">until</span> <span class="variable">the</span> <span class="variable">reply</span><span class="operator">-</span><span class="variable">getting</span> <span class="variable">process</span>
    <span class="variable">is</span> <span class="variable">completed</span><span class="operator">.</span> <span class="variable">So</span> <span class="variable">tags</span> <span class="variable">like</span> <span class="operator">{</span><span class="variable">uppercase</span><span class="operator">}</span> <span class="variable">can</span> <span class="variable">modify</span> <span class="variable">the</span> <span class="variable">final</span> <span class="variable">returned</span> <span class="variable">reply</span><span class="operator">.</span>
</pre>
<pre>
  Version 0.12
  - Migrated to RiveScript:: namespace.</pre>
<pre>
  Version 0.11
  - When calling loadDirectory, a &quot;begin.rs&quot; file is always loaded first
    (provided the file exists, of course!)
  - Added support for &quot;include&quot;ing libraries and packages (see &quot;INCLUDED FILES&quot;)</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">10</span>
  <span class="operator">-</span> <span class="variable">The</span> <span class="variable">getUservars</span><span class="operator">()</span> <span class="variable">method</span> <span class="variable">now</span> <span class="variable">returns</span> <span class="variable">a</span> <span class="variable">hashref</span> <span class="variable">of</span> <span class="variable">hashrefs</span> <span class="keyword">if</span> <span class="variable">you</span> <span class="variable">want</span> <span class="variable">the</span>
    <span class="variable">vars</span> <span class="variable">of</span> <span class="variable">all</span> <span class="variable">users</span><span class="operator">.</span> <span class="variable">Makes</span> <span class="variable">it</span> <span class="variable">a</span> <span class="variable">little</span> <span class="variable">easier</span> <span class="variable">to</span> <span class="variable">label</span> <span class="keyword">each</span> <span class="variable">set</span> <span class="variable">of</span> <span class="variable">variables</span>
    <span class="variable">with</span> <span class="variable">the</span> <span class="variable">particular</span> <span class="variable">user</span> <span class="variable">involved</span><span class="operator">.</span> <span class="operator">;)</span>
  <span class="operator">-</span> <span class="variable">Cleaned</span> <span class="variable">up</span> <span class="variable">some</span> <span class="variable">leftover</span> <span class="keyword">print</span> <span class="variable">statements</span> <span class="variable">from</span> <span class="keyword">my</span> <span class="variable">debugging</span> <span class="variable">in</span> <span class="variable">version</span> <span class="number">0</span><span class="operator">.</span><span class="number">09</span>
    <span class="operator">(</span><span class="variable">sorry</span> <span class="variable">about</span> <span class="variable">that</span><span class="operator">--</span><span class="variable">again</span><span class="operator">!)</span>
  <span class="operator">-</span> <span class="variable">Made</span> <span class="variable">some</span> <span class="variable">revisions</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">POD</span><span class="operator">,</span> <span class="variable">fixed</span> <span class="variable">some</span> <span class="variable">typo's</span><span class="operator">,</span> <span class="variable">added</span> <span class="operator">{</span><span class="variable">weight</span><span class="operator">}</span> <span class="keyword">and</span> <span class="operator">{</span><span class="variable">ok</span><span class="operator">}</span>
    <span class="variable">to</span> <span class="variable">the</span> <span class="variable">TAGS</span> <span class="variable">section</span><span class="operator">.</span>
</pre>
<pre>
  Version 0.09
  - $1 to $100+ are now done using an array rather than a hash. Theoretically
    this allows any number of stars, even greater than 100.
  - Arrays in triggers have been modified. An array in parenthesis (the former
    requirement) will make the array matchable in &lt;star#&gt; tags. An array outside
    of parenthesis makes it NOT matchable.
  - Minor code improvements for readibility purposes.</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">08</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="operator">&lt;</span><span class="variable">add</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">sub</span><span class="operator">&gt;,</span> <span class="operator">&lt;</span><span class="variable">mult</span><span class="operator">&gt;,</span> <span class="keyword">and</span> <span class="operator">&lt;</span><span class="variable">div</span><span class="operator">&gt;</span> <span class="variable">tags</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="variable">environmental</span> <span class="variable">variable</span> <span class="variable">support</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Extended</span> <span class="variable">*CONDITION</span> <span class="variable">to</span> <span class="variable">support</span> <span class="variable">inequalities</span>
  <span class="operator">-</span> <span class="variable">Botvars</span> <span class="variable">in</span> <span class="variable">conditions</span> <span class="variable">must</span> <span class="variable">be</span> <span class="variable">explicitely</span> <span class="variable">specified</span> <span class="variable">with</span> <span class="comment"># before the varname.</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="string">"! person"</span> <span class="variable">substitutions</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="operator">{</span><span class="variable">person</span><span class="operator">}</span> <span class="variable">tag</span>
</pre>
<pre>
  Version 0.07
  - Added write() method
  - reply() method now can take tags to force scalar return or to ignore
    sentence-splitting.
  - loadDirectory() method can now take a list of specific file extensions
    to look for.
  - Cleaned up some leftover debug prints from last release (sorry about that!)</pre>
<pre>
  Version 0.06
  - Extended ^CONTINUE to cover more commands
  - Added \s and \n tags
  - Revised POD</pre>
<pre>
  Version 0.05
  - Fixed a bug with optionals. If they were used at the start or end
    of a trigger, the trigger became unmatchable. This has been fixed
    by changing ' ' into '\s*'</pre>
<pre>
  Version 0.04
  - Added support for optional parts of the trigger.
  - Begun support for inline objects to be created.</pre>
<pre>
  Version 0.03
  - Added search() method.
  - &lt;bot&gt; variables can be inserted into triggers now (for example having
    the bot reply to its name no matter what its name is)</pre>
<pre>
  <span class="variable">Version</span> <span class="number">0</span><span class="operator">.</span><span class="number">02</span>
  <span class="operator">-</span> <span class="variable">Fixed</span> <span class="variable">a</span> <span class="variable">regexp</span> <span class="variable">bug</span><span class="operator">;</span> <span class="variable">now</span> <span class="variable">it</span> <span class="variable">stops</span> <span class="variable">searching</span> <span class="variable">when</span> <span class="variable">it</span> <span class="variable">finds</span> <span class="variable">a</span> <span class="variable">match</span>
    <span class="operator">(</span><span class="variable">it</span> <span class="variable">would</span> <span class="variable">cause</span> <span class="variable">errors</span> <span class="variable">with</span> <span class="variable">$1</span> <span class="variable">to</span> <span class="variable">$100</span><span class="operator">)</span>
  <span class="operator">-</span> <span class="variable">Fixed</span> <span class="variable">an</span> <span class="variable">inconsistency</span> <span class="variable">that</span> <span class="variable">didn't</span> <span class="variable">allow</span> <span class="variable">uservars</span> <span class="variable">to</span> <span class="variable">work</span> <span class="variable">in</span>
    <span class="variable">conditionals</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Added</span> <span class="operator">&lt;</span><span class="variable">id</span><span class="operator">&gt;</span> <span class="variable">tag</span><span class="operator">,</span> <span class="variable">useful</span> <span class="keyword">for</span> <span class="variable">objects</span> <span class="variable">that</span> <span class="variable">need</span> <span class="variable">a</span> <span class="variable">unique</span> <span class="variable">user</span> <span class="variable">to</span> <span class="variable">work</span>
    <span class="variable">with</span><span class="operator">.</span>
  <span class="operator">-</span> <span class="variable">Fixed</span> <span class="variable">bug</span> <span class="variable">that</span> <span class="variable">lets</span> <span class="variable">comments</span> <span class="variable">begin</span> <span class="variable">with</span> <span class="variable">more</span> <span class="variable">than</span> <span class="variable">one</span> <span class="variable">set</span> <span class="variable">of</span> <span class="operator">/</span><span class="regex">/
  </span>
</pre>
<pre>
  Version 0.01
  - Initial Release</pre>
<p>
</p>
<hr />
<h1><a name="special_thanks">SPECIAL THANKS</a></h1>
<p>Special thanks goes out to <strong>jeffohrt</strong> and <strong>harleypig</strong> of the AiChaos Forum for
helping so much with RiveScript's development.</p>
<p>
</p>
<hr />
<h1><a name="keywords">KEYWORDS</a></h1>
<p>bot, chatbot, chatterbot, chatter bot, reply, replies, script, aiml, alpha</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<pre>
  Cerone Kirsle, kirsle --at-- f2mb.com</pre>
<p>
</p>
<hr />
<h1><a name="copyright_and_license">COPYRIGHT AND LICENSE</a></h1>
<pre>
    RiveScript - Rendering Intelligence Very Easily
    Copyright (C) 2006  Cerone J. Kirsle</pre>
<pre>
    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.</pre>
<pre>
    <span class="variable">This</span> <span class="variable">program</span> <span class="variable">is</span> <span class="variable">distributed</span> <span class="variable">in</span> <span class="variable">the</span> <span class="variable">hope</span> <span class="variable">that</span> <span class="variable">it</span> <span class="variable">will</span> <span class="variable">be</span> <span class="variable">useful</span><span class="operator">,</span>
    <span class="variable">but</span> <span class="variable">WITHOUT</span> <span class="variable">ANY</span> <span class="variable">WARRANTY</span><span class="operator">;</span> <span class="variable">without</span> <span class="variable">even</span> <span class="variable">the</span> <span class="variable">implied</span> <span class="variable">warranty</span> <span class="variable">of</span>
    <span class="variable">MERCHANTABILITY</span> <span class="keyword">or</span> <span class="variable">FITNESS</span> <span class="variable">FOR</span> <span class="variable">A</span> <span class="variable">PARTICULAR</span> <span class="variable">PURPOSE</span><span class="operator">.</span>  <span class="variable">See</span> <span class="variable">the</span>
    <span class="variable">GNU</span> <span class="variable">General</span> <span class="variable">Public</span> <span class="variable">License</span> <span class="keyword">for</span> <span class="variable">more</span> <span class="variable">details</span><span class="operator">.</span>
</pre>
<pre>
    <span class="variable">You</span> <span class="variable">should</span> <span class="variable">have</span> <span class="variable">received</span> <span class="variable">a</span> <span class="variable">copy</span> <span class="variable">of</span> <span class="variable">the</span> <span class="variable">GNU</span> <span class="variable">General</span> <span class="variable">Public</span> <span class="variable">License</span>
    <span class="variable">along</span> <span class="variable">with</span> <span class="variable">this</span> <span class="variable">program</span><span class="operator">;</span> <span class="keyword">if</span> <span class="keyword">not</span><span class="operator">,</span> <span class="keyword">write</span> <span class="variable">to</span> <span class="variable">the</span> <span class="variable">Free</span> <span class="variable">Software</span>
    <span class="variable">Foundation</span><span class="operator">,</span> <span class="variable">Inc</span><span class="operator">.,</span> <span class="number">59</span> <span class="variable">Temple</span> <span class="variable">Place</span><span class="operator">,</span> <span class="variable">Suite</span> <span class="number">330</span><span class="operator">,</span> <span class="variable">Boston</span><span class="operator">,</span> <span class="variable">MA</span>  <span class="number">02111</span><span class="operator">-</span><span class="number">1307</span>  <span class="variable">USA</span>
</pre>

</body>

</html>
